<div
  *ngIf="pokemon"
  class="relative w-full max-w-105 mx-auto rounded-4xl overflow-hidden bg-white/5 shadow-2xl flex flex-col font-sans border border-white/5 transition-all duration-500"
>
  <!-- Background Elements -->
  <div
    class="absolute inset-0 bg-dot-grid opacity-30 pointer-events-none"
  ></div>
  <div
    class="absolute top-[10%] left-1/2 -translate-x-1/2 w-75 h-75 rounded-full blur-[80px] opacity-20 pointer-events-none mix-blend-screen"
    [style.background-color]="'var(--color-type-' + pokemon.types[0] + ')'"
  ></div>

  <!-- Header -->
  <div class="relative z-10 flex items-center justify-between px-6 pt-6 mb-4">
    <button
      (click)="prev.emit()"
      class="w-10 h-10 flex items-center justify-center rounded-xl bg-white/10 border border-white/10 text-white/70 hover:bg-white/10 transition-colors cursor-pointer"
    >
      <svg
        class="w-5 h-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 19l-7-7 7-7"
        ></path>
      </svg>
    </button>

    <div
      class="flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl px-5 py-2 backdrop-blur-md shadow-lg max-w-[200px] sm:max-w-none"
    >
      <img src="assets/pokeball.svg" class="w-5 h-5 opacity-80 shrink-0" />
      <span
        class="text-white font-mono font-bold text-lg tracking-tight truncate"
        >{{ pokemon.number }} {{ pokemon.name | titlecase }}</span
      >
    </div>

    <button
      (click)="next.emit()"
      class="w-10 h-10 flex items-center justify-center rounded-xl bg-white/10 border border-white/10 text-white/70 hover:bg-white/10 transition-colors cursor-pointer"
    >
      <svg
        class="w-5 h-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"
        ></path>
      </svg>
    </button>
  </div>

  <!-- Image -->
  <div class="relative z-20 h-65 flex items-center justify-center -mt-2 group">
    <img
      [ngSrc]="pokemon.sprites.regular"
      [alt]="pokemon.name"
      fill
      priority
      class="object-contain drop-shadow-[0_10px_30px_rgba(0,0,0,0.5)] transform transition-transform duration-500 group-hover:scale-110 will-change-transform"
    />
  </div>

  <!-- Info Panels Container -->
  <div class="relative z-30 flex-1 px-5 pb-6 flex flex-col gap-4">
    <!-- Physical & Types -->
    <div
      class="glass-card rounded-2xl p-4 flex justify-between items-center text-center"
    >
      <div class="flex flex-col gap-1 w-1/3 border-r border-white/10">
        <span class="text-white font-mono text-lg font-bold"
          >{{ pokemon.physic.weight }} kg</span
        >
        <span
          class="text-white/40 text-[10px] font-bold uppercase tracking-wider"
          >Weight</span
        >
      </div>

      <div class="flex flex-col gap-2 items-center w-1/3 px-2">
        <div class="flex gap-2 justify-center">
          <img
            *ngFor="let type of pokemon.types"
            [src]="'assets/types/poketype-' + type + '.svg'"
            class="w-6 h-6 drop-shadow-md"
            [title]="type"
          />
        </div>
        <span
          class="text-white/40 text-[9px] font-bold uppercase tracking-wider truncate w-full"
          >{{ pokemon.types.join(" / ") }}</span
        >
      </div>

      <div class="flex flex-col gap-1 w-1/3 border-l border-white/10">
        <span class="text-white font-mono text-lg font-bold"
          >{{ pokemon.physic.height }} m</span
        >
        <span
          class="text-white/40 text-[10px] font-bold uppercase tracking-wider"
          >Height</span
        >
      </div>
    </div>

    <!-- Moves -->
    <div class="glass-card rounded-2xl p-4 flex flex-col gap-3">
      <div
        *ngFor="let move of pokemon.moves.slice(0, 3)"
        class="flex items-center justify-between"
      >
        <div class="flex items-center gap-3">
          <div
            class="w-6 h-6 rounded-full flex items-center justify-center bg-white/10 p-1"
          >
            <img
              [src]="'assets/types/poketype-' + move.type + '.svg'"
              class="w-full h-full opacity-80"
            />
          </div>
          <span class="text-white font-mono text-sm font-medium">{{
            move.name | titlecase
          }}</span>
        </div>

        <div class="flex items-center gap-3">
          <!-- Power Bars -->
          <div class="flex gap-0.5">
            <div
              *ngFor="let bar of [1, 2, 3, 4, 5]; let i = index"
              class="w-3 h-1.5 rounded-sm"
              [ngClass]="
                i < (move.powerSegments || 0)
                  ? 'bg-[(--primary-color)]'
                  : 'bg-white/10'
              "
              [style]="
                i < (move.powerSegments || 0)
                  ? '--primary-color: var(--color-type-' + move.type + ')'
                  : ''
              "
            ></div>
          </div>
          <span
            class="text-white/60 font-mono text-sm font-bold w-6 text-right"
            >{{ move.damage || "00" }}</span
          >
        </div>
      </div>
    </div>

    <!-- Stats Grid -->
    <div
      class="glass-card rounded-2xl p-5 grid grid-cols-3 gap-y-4 gap-x-2 text-center"
    >
      <!-- HP -->
      <div class="flex flex-col gap-0.5">
        <span class="text-white font-mono font-bold text-xl"
          >{{ pokemon.stats.health }}/{{ pokemon.stats.health }}</span
        >
        <span
          class="text-white/30 text-[9px] font-bold uppercase tracking-widest"
          >HP</span
        >
      </div>
      <!-- Attack -->
      <div class="flex flex-col gap-0.5">
        <span class="text-white font-mono font-bold text-xl"
          >+{{ pokemon.stats.attack }}</span
        >
        <span
          class="text-white/30 text-[9px] font-bold uppercase tracking-widest"
          >Attack</span
        >
      </div>
      <!-- Defense -->
      <div class="flex flex-col gap-0.5">
        <span class="text-white font-mono font-bold text-xl"
          >+{{ pokemon.stats.defense }}</span
        >
        <span
          class="text-white/30 text-[9px] font-bold uppercase tracking-widest"
          >Defense</span
        >
      </div>
      <!-- Resistance -->
      <div class="flex flex-col gap-0.5">
        <span class="text-white font-mono font-bold text-xl"
          >+{{ pokemon.stats.resistance }}</span
        >
        <span
          class="text-white/30 text-[9px] font-bold uppercase tracking-widest"
          >Resistance</span
        >
      </div>
      <!-- Speed -->
      <div class="flex flex-col gap-0.5">
        <span class="text-white font-mono font-bold text-xl"
          >+{{ pokemon.stats.speed }}</span
        >
        <span
          class="text-white/30 text-[9px] font-bold uppercase tracking-widest"
          >Speed</span
        >
      </div>
      <!-- Level (Dummy) -->
      <div class="flex flex-col gap-0.5">
        <span class="text-white font-mono font-bold text-xl">50/50</span>
        <span
          class="text-white/30 text-[9px] font-bold uppercase tracking-widest"
          >Level</span
        >
      </div>
    </div>

    <!-- Flavor Text -->
    <div class="px-2">
      <p
        class="text-white/50 text-[10px] leading-relaxed text-center font-mono"
      >
        {{ pokemon.name | titlecase }} can be seen napping in bright sunlight.
        There is a seed on its back. By soaking up the sun's rays, the seed
        grows progressively larger.
      </p>
    </div>
  </div>
</div>
